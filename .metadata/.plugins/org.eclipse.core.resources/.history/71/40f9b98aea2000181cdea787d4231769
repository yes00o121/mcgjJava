package com.yc.tieba;

import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import com.yc.Util;

/**
 * 贴吧对象
 * @author ad
 *下载的过程，指定贴吧名称，找到贴吧读取默认页数，对每一个贴子进行解析，进入楼层同时解析当前用户是否存在，如存在继续进行数据的写入，不存在将该用户入库，默认读取完所有楼层后继续下一个贴子抓取
 */
public class Conversation {
	
	private String address = "http://127.0.0.1:8090";//本地服务器地址
	
	private String tiebaUrl = "https://tieba.baidu.com/f?fr=wwwt&kw=";//贴吧地址
	
	private String tiebaName;//贴吧名称
	
//	private static String HREF_REGULAR = "href=\"(/p.*\")";
	private static String HREF_REGULAR = "href=\"(/p/2798043647).*?";
	
	private Integer defaultLimit = 20;//默认下载的贴子数
	
	public Conversation(){
		
	}
	public Conversation(String tiebaName){
		this.tiebaName = tiebaName;
		this.running();//运行
	}
	//运行下载贴吧数据
	private void running(){
		
		String url = Util.getHTML(this.tiebaUrl+this.tiebaName+"&pn=0");//贴吧主页的url
		this.analysisUrl(url);
	}
	//解析当前贴吧的中所有帖子的url
	private String analysisUrl(String url){
		try {
			List<String> imgs = new ArrayList<String>();
			Pattern pattern = Pattern.compile(HREF_REGULAR);
//			Pattern patternBase64 = Pattern.compile(IMAGE_REGULAR_BASE64);
			Matcher matcher = pattern.matcher(url);
			while(matcher.find()){
				imgs.add(matcher.group());
			}
			System.out.println(imgs);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
	
	
}
